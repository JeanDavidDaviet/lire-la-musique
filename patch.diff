From d0958e3fd6ae9f5a9888b749d08c01db7681abe8 Mon Sep 17 00:00:00 2001
From: Jean-David Daviet <jeandaviddaviet@gmail.com>
Date: Sun, 13 Feb 2022 16:31:42 +0100
Subject: [PATCH] begin add link to chords and reorganize routes

---
 src/components/App.js           | 13 ++++++++-----
 src/components/Layout/Header.js | 28 ++++++++++++++++++++++++++++
 src/components/Pages/Home.js    | 26 +++++++++++++++-----------
 src/index.css                   |  2 +-
 src/translations.js             |  4 ++++
 5 files changed, 56 insertions(+), 17 deletions(-)

diff --git a/src/components/App.js b/src/components/App.js
index 20e6d66..9769f41 100644
--- a/src/components/App.js
+++ b/src/components/App.js
@@ -1,5 +1,5 @@
 import React from 'react';
-import { Route, Routes } from "react-router-dom";
+import { Navigate, Route, Routes } from "react-router-dom";
 import Home from './Pages/Home';
 import ChangeLogEN from './Pages/ChangeLogEN';
 import ChangeLogFR from './Pages/ChangeLogFR';
@@ -9,10 +9,13 @@ const App = () => (
   <React.Fragment>
     <Header/>
     <Routes>
-      <Route exact path="/" element={<Home />} />
-      <Route path="/chords/:chord" render={(props) => <Home {...props} />} />
-      <Route path="/en/changelog" element={<ChangeLogEN />} />
-      <Route path="/fr/changelog" element={<ChangeLogFR />} />
+      <Route path="/" element={<Home />}>
+        <Route path="chords" element={<Navigate to="/chords/A" replace={true} />}>
+          <Route path=":chord" element={<Home />} />
+        </Route>
+        <Route path="en/changelog" element={<ChangeLogEN />} />
+        <Route path="fr/changelog" element={<ChangeLogFR />} />
+      </Route>
     </Routes>
   </React.Fragment>
 )
diff --git a/src/components/Layout/Header.js b/src/components/Layout/Header.js
index 651ca76..e49ee23 100644
--- a/src/components/Layout/Header.js
+++ b/src/components/Layout/Header.js
@@ -10,13 +10,41 @@ import { useTranslation } from "react-i18next";
 import i18n from '../../i18n';
 import { useMedia } from '../../useMedia';
 import FullScreen from '../Controls/FullScreen';
+import { Drawer, IconButton } from '@material-ui/core';
+import { ChevronLeft, Menu } from '@material-ui/icons';
 
 const Header = () => {
   const isSmallHeight = useMedia([`(max-height: ${config.isSmallHeight}px)`],[true],false);
   const { t } = useTranslation();
+  const [open, setOpen] = React.useState(false);
+
+  const handleDrawerOpen = () => {
+    setOpen(true);
+  };
+
+  const handleDrawerClose = () => {
+    setOpen(false);
+  };
+
   return (
     <AppBar position="static">
       <Toolbar variant={isSmallHeight ? 'dense' : 'regular'}>
+        <IconButton color="inherit" onClick={handleDrawerOpen} edge="start">
+          <Menu />
+        </IconButton>
+        <Drawer variant="persistent" anchor="left" open={open}>
+          <IconButton onClick={handleDrawerClose}>
+            <ChevronLeft />
+          </IconButton>
+          <div style={{ padding: '10px' }}>
+            <Typography variant="body1">
+              <Link to="/" >{t('Notes')}</Link>
+            </Typography>
+            <Typography variant="body1">
+              <Link to="/chords" >{t('Chords')}</Link>
+            </Typography>
+          </div>
+        </Drawer>
         <Typography variant="h6" color="inherit">
           <Link to="/" className="logo">{t('Read the music')}</Link>
         </Typography>
diff --git a/src/components/Pages/Home.js b/src/components/Pages/Home.js
index 0abfe65..4cc36e4 100644
--- a/src/components/Pages/Home.js
+++ b/src/components/Pages/Home.js
@@ -22,6 +22,7 @@ import { setRunning, setVolume, setTempo, setScale, setClef, setTime, setInstrum
 import ControlsVolume from '../Controls/ControlsRunning';
 import { useMedia } from '../../useMedia.js';
 import Notation from '../Layout/Notation.js';
+import { useParams } from 'react-router-dom';
 
 window.notes = [];
 
@@ -82,17 +83,20 @@ const Home = ({ chord, running, volume, tempo, chosenScale, clef, time, instrume
   );
 }
 
-const mapStateToProps = (state, props) => ({
-  // chord: props.match.params.chord,
-  running: state.configReducer.running,
-  volume: state.configReducer.volume,
-  tempo: state.tempoReducer.tempo,
-  chosenScale: state.scaleReducer.chosenScale,
-  clef: state.configReducer.clef,
-  time: state.configReducer.time,
-  instrument: state.configReducer.instrument,
-  notation: state.configReducer.notation,
-});
+const mapStateToProps = (state, props) => {
+  // const params = useParams();
+  return {
+    // chord: params.chord,
+    running: state.configReducer.running,
+    volume: state.configReducer.volume,
+    tempo: state.tempoReducer.tempo,
+    chosenScale: state.scaleReducer.chosenScale,
+    clef: state.configReducer.clef,
+    time: state.configReducer.time,
+    instrument: state.configReducer.instrument,
+    notation: state.configReducer.notation,
+  }
+}
 
 const mapDispatchToProps = dispatch => ({
   setRunning: () => dispatch(setRunning()),
diff --git a/src/index.css b/src/index.css
index 442f51f..0ba16e9 100644
--- a/src/index.css
+++ b/src/index.css
@@ -12,7 +12,7 @@ body, #root {
   flex-direction: column;
 }
 
-svg {
+#root > svg {
   width: 100%;
   width: calc(100% - 25px);
   margin-left: 25px;
diff --git a/src/translations.js b/src/translations.js
index e4f35e4..fd0cbef 100644
--- a/src/translations.js
+++ b/src/translations.js
@@ -38,6 +38,8 @@ export default {
       'Accelerate tempo up 20 bpm': 'Accelerate tempo up 20 bpm',
       'Right arrow': 'Right arrow',
       'Decelerate tempo up 20 bpm': 'Decelerate tempo up 20 bpm',
+      'Notes': 'Notes',
+      'Chords': 'Chords',
     }
   },
   fr: {
@@ -79,6 +81,8 @@ export default {
       'Accelerate tempo up 20 units': 'Accélerer le tempo de 20 bpm',
       'Right arrow': 'Flèche droite',
       'Decelerate tempo up 20 units': 'Ralentir le tempo de 20 bpm',
+      'Notes': 'Notes',
+      'Chords': 'Accords',
     }
   }
 };
-- 
2.37.0

